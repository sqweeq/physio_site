{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Brandon\\\\Documents\\\\projects\\\\physio_site\\\\client\\\\src\\\\components\\\\CartModal.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { deleteItem, addItemToCart, getItems, addItem, getGuestCartItems, clearGuestCart, deleteGuestItem, clearUserCart } from \"../actions/itemActions\";\nimport { Modal, Button } from \"bootstrap-4-react\";\nimport { withRouter } from \"react-router-dom\";\n\nclass CartModal extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      itemsCleared: false\n    };\n\n    this.onClearUserCart = (user, items) => {\n      this.props.clearUserCart(user, items);\n    };\n\n    this.onClearGuestCart = () => {\n      this.props.clearGuestCart();\n    };\n\n    this.deleteGuestCartItem = item => {\n      this.props.deleteGuestItem(item);\n      this.props.getGuestCartItems();\n    };\n  }\n\n  //clear items button interval\n  onClearItemsButton() {\n    clearInterval(this.state.itemsCleared);\n    this.setState({\n      itemsCleared: true\n    }, () => {\n      setInterval(() => {\n        this.setState({\n          itemsCleared: false\n        });\n      }, 5000);\n    });\n  } // clear user cart\n\n\n  render() {\n    const {\n      items\n    } = this.props.item;\n    const {\n      user\n    } = this.props.auth;\n    const {\n      isAuthenticated\n    } = this.props.auth;\n    const {\n      guestCart\n    } = this.props.item;\n\n    const deleteCartItem = item => {\n      this.props.getItems();\n      this.props.deleteItem(item._id);\n    }; // filter items in db that is the user's\n\n\n    let cartFilteredItems = isAuthenticated ? items.filter(item => item.userRefID !== \"\" && item.userRefID === user._id) : guestCart; // cart math\n\n    let cartTotal = cartFilteredItems && cartFilteredItems.reduce((prev, current) => prev + current.price, 0);\n    let shippingCost = cartTotal && cartTotal > 100 ? 0 : 7.99;\n    let cartTotalTax = cartTotal && cartTotal * 0.15;\n    let cartTotalWithTax = cartTotal && cartTotal + cartTotalTax + shippingCost;\n\n    const loggedCheckout = () => {\n      this.props.history.push({\n        pathname: \"/payment\",\n        state: cartTotalWithTax\n      });\n    };\n\n    const guestCheckout = () => {\n      this.props.history.push({\n        pathname: \"/payment\",\n        state: cartTotalWithTax\n      });\n    };\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Modal, {\n      id: \"exampleModal\",\n      fade: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Modal.Dialog, {\n      centered: true,\n      className: \"m-auto\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Modal.Content, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Modal.Header, {\n      className: \"p-3 border-dark\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Modal.Title, {\n      style: {\n        textTransform: \"capitalize\"\n      },\n      className: \"float-left w-25 font-wieght-bolder\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }\n    }, isAuthenticated ? `${user.name}'s Cart` : \"Guest Cart\"), /*#__PURE__*/React.createElement(Modal.Close, {\n      className: \"float-right modal-closing\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      className: \"float-right mr-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 19\n      }\n    }, \"\\xD7\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"py-3 w-75 mx-auto\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }\n    }, \"My Bag\"), /*#__PURE__*/React.createElement(\"h5\", {\n      className: \"m-3 mx-auto\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 17\n      }\n    }, \"Qty in cart:\", \" \", cartFilteredItems && cartFilteredItems.length === null ? 0 : cartFilteredItems && cartFilteredItems.length), cartFilteredItems && cartFilteredItems.map((item, i) => /*#__PURE__*/React.createElement(\"div\", {\n      className: \"py-4 row border-top border-bottom border-secondary \",\n      key: i,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-6 image-container m-auto\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"img-fluid center-block w-100 align-items-center\",\n      src: item.productImage,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-6 d-flex flex-column justify-content-between\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      className: \"pb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 25\n      }\n    }, item.name), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"pb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 25\n      }\n    }, \"Description: \", item.description), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"pb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 25\n      }\n    }, \"Price: $\", item.price), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-primary w-50 p-2\",\n      onClick: isAuthenticated ? () => deleteCartItem(item) : () => this.deleteGuestCartItem(item),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 27\n      }\n    }, \"Remove\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"m-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 27\n      }\n    })))))), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      className: \"col-12 my-2 p-2 w-75 mx-auto mb-4 btn \" + (!this.state.itemsCleared ? \"btn-info\" : \"btn-success\"),\n      onClick: isAuthenticated ? () => {\n        this.onClearUserCart(user, items);\n        this.onClearItemsButton();\n      } : () => {\n        this.onClearGuestCart();\n        this.onClearItemsButton();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 15\n      }\n    }, !this.state.itemsCleared ? \"Reset Cart\" : \"Cart Cleared!\"), /*#__PURE__*/React.createElement(Modal.Footer, {\n      className: \"border-dark row px-5 py-3 \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"justify-content-center w-100\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      className: \"pt-4 pb-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 19\n      }\n    }, \"Cart Total: \", cartTotal && cartTotal.toFixed(2)), /*#__PURE__*/React.createElement(\"h5\", {\n      className: \" pt-2 pb-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 19\n      }\n    }, \"Shipping & Handling:\", \" \", cartTotal > 100 ? \"FREE\" : cartTotal === 0 ? \"0\" : shippingCost), /*#__PURE__*/React.createElement(\"h5\", {\n      className: \"pt-2 pb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 19\n      }\n    }, \"Tax: \", cartTotalTax && cartTotalTax.toFixed(2))), /*#__PURE__*/React.createElement(\"h3\", {\n      className: \"font-weight-bolder border-top border-secondary py-4 w-100\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 17\n      }\n    }, \"Order total (\", cartFilteredItems && cartFilteredItems.length, \" \", \"item): $\", cartTotalWithTax && cartTotalWithTax.toFixed(2)), /*#__PURE__*/React.createElement(Button, {\n      className: \"col-12 my-1 p-2 my-3\",\n      secondary: true,\n      \"data-dismiss\": \"modal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 17\n      }\n    }, \"Close cart\"), /*#__PURE__*/React.createElement(Button, {\n      \"data-dismiss\": \"modal\",\n      className: \"btn btn-primary btn-danger col-12 mt-2 mb-4 w-25 p-2\",\n      onClick: isAuthenticated ? () => loggedCheckout(cartTotalWithTax) : () => guestCheckout(cartTotalWithTax),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 17\n      }\n    }, \"PROCEED TO CHECKOUT\"))))));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  item: state.item,\n  auth: state.auth\n});\n\nexport default connect(mapStateToProps, {\n  deleteItem,\n  addItemToCart,\n  addItem,\n  getItems,\n  getGuestCartItems,\n  clearGuestCart,\n  deleteGuestItem,\n  clearUserCart\n})(withRouter(CartModal));","map":{"version":3,"sources":["C:/Users/Brandon/Documents/projects/physio_site/client/src/components/CartModal.js"],"names":["React","Component","connect","deleteItem","addItemToCart","getItems","addItem","getGuestCartItems","clearGuestCart","deleteGuestItem","clearUserCart","Modal","Button","withRouter","CartModal","state","itemsCleared","onClearUserCart","user","items","props","onClearGuestCart","deleteGuestCartItem","item","onClearItemsButton","clearInterval","setState","setInterval","render","auth","isAuthenticated","guestCart","deleteCartItem","_id","cartFilteredItems","filter","userRefID","cartTotal","reduce","prev","current","price","shippingCost","cartTotalTax","cartTotalWithTax","loggedCheckout","history","push","pathname","guestCheckout","textTransform","name","length","map","i","productImage","description","toFixed","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  deleteItem,\r\n  addItemToCart,\r\n  getItems,\r\n  addItem,\r\n  getGuestCartItems,\r\n  clearGuestCart,\r\n  deleteGuestItem,\r\n  clearUserCart\r\n} from \"../actions/itemActions\";\r\nimport { Modal, Button } from \"bootstrap-4-react\";\r\nimport { withRouter } from \"react-router-dom\";\r\nclass CartModal extends Component {\r\n  state = {\r\n    itemsCleared: false\r\n  };\r\n  //clear items button interval\r\n  onClearItemsButton() {\r\n    clearInterval(this.state.itemsCleared);\r\n    this.setState(\r\n      {\r\n        itemsCleared: true\r\n      },\r\n      () => {\r\n        setInterval(() => {\r\n          this.setState({\r\n            itemsCleared: false\r\n          });\r\n        }, 5000);\r\n      }\r\n    );\r\n  }\r\n  // clear user cart\r\n  onClearUserCart = (user, items) => {\r\n    this.props.clearUserCart(user, items);\r\n  };\r\n\r\n  onClearGuestCart = () => {\r\n    this.props.clearGuestCart();\r\n  };\r\n  // delete guest cart\r\n  deleteGuestCartItem = item => {\r\n    this.props.deleteGuestItem(item);\r\n    this.props.getGuestCartItems();\r\n  };\r\n\r\n  render() {\r\n    const { items } = this.props.item;\r\n    const { user } = this.props.auth;\r\n    const { isAuthenticated } = this.props.auth;\r\n    const { guestCart } = this.props.item;\r\n\r\n    const deleteCartItem = item => {\r\n      this.props.getItems();\r\n      this.props.deleteItem(item._id);\r\n    };\r\n    // filter items in db that is the user's\r\n    let cartFilteredItems = isAuthenticated\r\n      ? items.filter(\r\n          item => item.userRefID !== \"\" && item.userRefID === user._id\r\n        )\r\n      : guestCart;\r\n    // cart math\r\n    let cartTotal =\r\n      cartFilteredItems &&\r\n      cartFilteredItems.reduce((prev, current) => prev + current.price, 0);\r\n    let shippingCost = cartTotal && cartTotal > 100 ? 0 : 7.99;\r\n    let cartTotalTax = cartTotal && cartTotal * 0.15;\r\n    let cartTotalWithTax = cartTotal && cartTotal + cartTotalTax + shippingCost;\r\n\r\n    const loggedCheckout = () => {\r\n      this.props.history.push({\r\n        pathname: \"/payment\",\r\n        state: cartTotalWithTax\r\n      });\r\n    };\r\n\r\n    const guestCheckout = () => {\r\n      this.props.history.push({\r\n        pathname: \"/payment\",\r\n        state: cartTotalWithTax\r\n      });\r\n    };\r\n\r\n    return (\r\n      <div>\r\n        <Modal id=\"exampleModal\" fade>\r\n          <Modal.Dialog centered className=\"m-auto\">\r\n            <Modal.Content>\r\n              <Modal.Header className=\"p-3 border-dark\">\r\n                <Modal.Title\r\n                  style={{ textTransform: \"capitalize\" }}\r\n                  className=\"float-left w-25 font-wieght-bolder\"\r\n                >\r\n                  {isAuthenticated ? `${user.name}'s Cart` : \"Guest Cart\"}\r\n                </Modal.Title>\r\n                <Modal.Close className=\"float-right modal-closing\">\r\n                  <span aria-hidden=\"true\" className=\"float-right mr-2\">\r\n                    &times;\r\n                  </span>\r\n                </Modal.Close>\r\n              </Modal.Header>\r\n\r\n              <div className=\"py-3 w-75 mx-auto\">\r\n                <h2>My Bag</h2>\r\n                <h5 className=\"m-3 mx-auto\">\r\n                  Qty in cart:{\" \"}\r\n                  {cartFilteredItems && cartFilteredItems.length === null\r\n                    ? 0\r\n                    : cartFilteredItems && cartFilteredItems.length}\r\n                </h5>\r\n\r\n                {cartFilteredItems &&\r\n                  cartFilteredItems.map((item, i) => (\r\n                    <div\r\n                      className=\"py-4 row border-top border-bottom border-secondary \"\r\n                      key={i}\r\n                    >\r\n                      <div className=\"col-6 image-container m-auto\">\r\n                        <img\r\n                          className=\"img-fluid center-block w-100 align-items-center\"\r\n                          src={item.productImage}\r\n                          alt=\"\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"col-6 d-flex flex-column justify-content-between\">\r\n                        {/* <p>{i}</p> */}\r\n                        {/* <h5>GuestID: {item.guestItemID && item.guestItemID}</h5> */}\r\n                        <h4 className=\"pb-3\">{item.name}</h4>\r\n                        <p className=\"pb-3\">Description: {item.description}</p>\r\n\r\n                        {/* <p>Category: {item.category}</p> */}\r\n                        <p className=\"pb-3\">Price: ${item.price}</p>\r\n                        <div className=\"text-center\">\r\n                          <button\r\n                            className=\"btn btn-primary w-50 p-2\"\r\n                            onClick={\r\n                              isAuthenticated\r\n                                ? () => deleteCartItem(item)\r\n                                : () => this.deleteGuestCartItem(item)\r\n                            }\r\n                          >\r\n                            Remove\r\n                          </button>\r\n\r\n                          <div className=\"m-3\"></div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n              </div>\r\n\r\n              <button\r\n                type=\"button\"\r\n                className={\r\n                  \"col-12 my-2 p-2 w-75 mx-auto mb-4 btn \" +\r\n                  (!this.state.itemsCleared ? \"btn-info\" : \"btn-success\")\r\n                }\r\n                onClick={\r\n                  isAuthenticated\r\n                    ? () => {\r\n                        this.onClearUserCart(user, items);\r\n                        this.onClearItemsButton();\r\n                      }\r\n                    : () => {\r\n                        this.onClearGuestCart();\r\n                        this.onClearItemsButton();\r\n                      }\r\n                }\r\n              >\r\n                {!this.state.itemsCleared ? \"Reset Cart\" : \"Cart Cleared!\"}\r\n              </button>\r\n\r\n              <Modal.Footer className=\"border-dark row px-5 py-3 \">\r\n                <div className=\"justify-content-center w-100\">\r\n                  <h5 className=\"pt-4 pb-2\">\r\n                    Cart Total: {cartTotal && cartTotal.toFixed(2)}\r\n                  </h5>\r\n                  <h5 className=\" pt-2 pb-2\">\r\n                    Shipping & Handling:{\" \"}\r\n                    {cartTotal > 100\r\n                      ? \"FREE\"\r\n                      : cartTotal === 0\r\n                      ? \"0\"\r\n                      : shippingCost}\r\n                  </h5>\r\n                  <h5 className=\"pt-2 pb-3\">\r\n                    Tax: {cartTotalTax && cartTotalTax.toFixed(2)}\r\n                  </h5>\r\n                </div>\r\n\r\n                <h3 className=\"font-weight-bolder border-top border-secondary py-4 w-100\">\r\n                  Order total ({cartFilteredItems && cartFilteredItems.length}{\" \"}\r\n                  item): ${cartTotalWithTax && cartTotalWithTax.toFixed(2)}\r\n                </h3>\r\n\r\n                <Button\r\n                  className=\"col-12 my-1 p-2 my-3\"\r\n                  secondary\r\n                  data-dismiss=\"modal\"\r\n                >\r\n                  Close cart\r\n                </Button>\r\n\r\n                <Button\r\n                  data-dismiss=\"modal\"\r\n                  className=\"btn btn-primary btn-danger col-12 mt-2 mb-4 w-25 p-2\"\r\n                  onClick={\r\n                    isAuthenticated\r\n                      ? () => loggedCheckout(cartTotalWithTax)\r\n                      : () => guestCheckout(cartTotalWithTax)\r\n                  }\r\n                >\r\n                  PROCEED TO CHECKOUT\r\n                </Button>\r\n              </Modal.Footer>\r\n            </Modal.Content>\r\n          </Modal.Dialog>\r\n        </Modal>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst mapStateToProps = state => ({\r\n  item: state.item,\r\n  auth: state.auth\r\n});\r\nexport default connect(mapStateToProps, {\r\n  deleteItem,\r\n  addItemToCart,\r\n  addItem,\r\n  getItems,\r\n  getGuestCartItems,\r\n  clearGuestCart,\r\n  deleteGuestItem,\r\n  clearUserCart\r\n})(withRouter(CartModal));\r\n"]},"metadata":{},"sourceType":"module"}