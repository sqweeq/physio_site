{"ast":null,"code":"var _jsxFileName = \"/Users/katie/Desktop/Brandon projects/physio_site/client/src/components/CartModal.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { deleteItem, getItems, addItem, getGuestCartItems, clearGuestCart, deleteGuestItem, clearUserCart } from \"../actions/itemActions\";\nimport { Modal, Button } from \"bootstrap-4-react\";\nimport { withRouter } from \"react-router-dom\";\n\nclass CartModal extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      itemsCleared: false\n    };\n\n    this.componentDidMount = () => {\n      this.addGuestCartToUser();\n    };\n\n    this.onClearUserCart = (user, items) => {\n      this.props.clearUserCart(user, items);\n    };\n\n    this.onClearGuestCart = () => {\n      this.props.clearGuestCart();\n    };\n\n    this.deleteGuestCartItem = item => {\n      this.props.deleteGuestItem(item);\n      this.props.getGuestCartItems();\n    };\n  }\n\n  onClearItemsButton() {\n    clearInterval(this.state.itemsCleared);\n    this.setState({\n      itemsCleared: true\n    }, () => {\n      setInterval(() => {\n        this.setState({\n          itemsCleared: false\n        });\n      }, 5000);\n    });\n  }\n\n  render() {\n    const items = this.props.item.items;\n    const user = this.props.auth.user;\n    const isAuthenticated = this.props.auth.isAuthenticated;\n    const guestCart = this.props.item.guestCart;\n\n    const deleteCartItem = item => {\n      this.props.getItems();\n      this.props.deleteItem(item._id);\n    };\n\n    let cartFilteredItems = isAuthenticated ? items.filter(item => item.userRefID !== \"\" && item.userRefID === user._id) : guestCart;\n    let cartTotal = cartFilteredItems && cartFilteredItems.reduce((prev, current) => prev + current.price, 0);\n    let shippingCost = cartTotal && cartTotal > 100 ? 0 : 7.99;\n    let cartTotalTax = cartTotal && cartTotal * 0.15;\n    let cartTotalWithTax = cartTotal && cartTotal + cartTotalTax + shippingCost;\n\n    const loggedCheckout = () => {\n      this.props.history.push({\n        pathname: \"/payment\",\n        state: cartTotalWithTax\n      });\n    };\n\n    const guestCheckout = () => {\n      this.props.history.push({\n        pathname: \"/payment\",\n        state: cartTotalWithTax\n      });\n    };\n\n    let unique = [...new Set(cartFilteredItems && cartFilteredItems.map(item => item.name))]; // const duplicateCart = unique.map(item => [\n    //   item,\n    //   unique.filter(str => str === item).length\n    // ]);\n    // console.log(unique);\n    // console.log(duplicateCart);\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, React.createElement(Modal, {\n      id: \"exampleModal\",\n      fade: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(Modal.Dialog, {\n      centered: true,\n      className: \"m-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(Modal.Content, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, React.createElement(Modal.Header, {\n      className: \"p-3 border-dark\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(Modal.Title, {\n      style: {\n        textTransform: \"capitalize\"\n      },\n      className: \"float-left w-25 font-wieght-bolder\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, isAuthenticated ? `${user.name}'s Cart` : \"Guest Cart\"), React.createElement(Modal.Close, {\n      className: \"float-right modal-closing\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      className: \"float-right mr-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, \"\\xD7\"))), React.createElement(\"div\", {\n      className: \"py-3 w-75 mx-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, \"My Bag\"), React.createElement(\"h5\", {\n      className: \"m-3 mx-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, \"Qty in cart:\", \" \", cartFilteredItems && cartFilteredItems.length === null ? 0 : cartFilteredItems && cartFilteredItems.length), cartFilteredItems && cartFilteredItems.map((item, i) => React.createElement(\"div\", {\n      className: \"py-4 row border-top border-bottom border-secondary \",\n      key: i,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-6 image-container m-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"img-fluid center-block w-100 align-items-center\",\n      src: item.productImage,\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"col-6 d-flex flex-column justify-content-between\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"pb-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, item.name), React.createElement(\"p\", {\n      className: \"pb-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, \"Description: \", item.description), React.createElement(\"p\", {\n      className: \"pb-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, \"Price: $\", item.price), React.createElement(\"div\", {\n      className: \"text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn btn-primary w-50 p-2\",\n      onClick: isAuthenticated ? () => deleteCartItem(item) : () => this.deleteGuestCartItem(item),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, \"Remove\"), React.createElement(\"div\", {\n      className: \"m-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    })))))), React.createElement(\"button\", {\n      type: \"button\",\n      className: \"col-12 my-2 p-2 w-75 mx-auto mb-4 btn \" + (!this.state.itemsCleared ? \"btn-info\" : \"btn-success\"),\n      onClick: isAuthenticated ? () => {\n        this.onClearUserCart(user, items);\n        this.onClearItemsButton();\n      } : () => {\n        this.onClearGuestCart();\n        this.onClearItemsButton();\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, !this.state.itemsCleared ? \"Reset Cart\" : \"Cart Cleared!\"), React.createElement(Modal.Footer, {\n      className: \"border-dark row px-5 py-3 \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"justify-content-center w-100\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      className: \"pt-4 pb-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, \"Cart Total: \", cartTotal && cartTotal.toFixed(2)), React.createElement(\"h5\", {\n      className: \" pt-2 pb-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, \"Shipping & Handling:\", \" \", cartTotal > 100 ? \"FREE\" : cartTotal === 0 ? \"0\" : shippingCost), React.createElement(\"h5\", {\n      className: \"pt-2 pb-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, \"Tax: \", cartTotalTax && cartTotalTax.toFixed(2))), React.createElement(\"h3\", {\n      className: \"font-weight-bolder border-top border-secondary py-4 w-100\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, \"Order total (\", cartFilteredItems && cartFilteredItems.length, \" \", \"item): $\", cartTotalWithTax && cartTotalWithTax.toFixed(2)), React.createElement(Button, {\n      className: \"col-12 my-1 p-2 my-3\",\n      secondary: true,\n      \"data-dismiss\": \"modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, \"Close cart\"), React.createElement(Button, {\n      \"data-dismiss\": \"modal\",\n      className: \"btn btn-primary btn-danger col-12 mt-2 mb-4 w-25 p-2\",\n      onClick: isAuthenticated ? () => loggedCheckout(cartTotalWithTax) : () => guestCheckout(cartTotalWithTax),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }, \"PROCEED TO CHECKOUT\"))))));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  item: state.item,\n  auth: state.auth\n});\n\nexport default connect(mapStateToProps, {\n  deleteItem,\n  addItem,\n  getItems,\n  getGuestCartItems,\n  clearGuestCart,\n  deleteGuestItem,\n  clearUserCart\n})(withRouter(CartModal));","map":{"version":3,"sources":["/Users/katie/Desktop/Brandon projects/physio_site/client/src/components/CartModal.js"],"names":["React","Component","connect","deleteItem","getItems","addItem","getGuestCartItems","clearGuestCart","deleteGuestItem","clearUserCart","Modal","Button","withRouter","CartModal","state","itemsCleared","componentDidMount","addGuestCartToUser","onClearUserCart","user","items","props","onClearGuestCart","deleteGuestCartItem","item","onClearItemsButton","clearInterval","setState","setInterval","render","auth","isAuthenticated","guestCart","deleteCartItem","_id","cartFilteredItems","filter","userRefID","cartTotal","reduce","prev","current","price","shippingCost","cartTotalTax","cartTotalWithTax","loggedCheckout","history","push","pathname","guestCheckout","unique","Set","map","name","textTransform","length","i","productImage","description","toFixed","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport {\n  deleteItem,\n  getItems,\n  addItem,\n  getGuestCartItems,\n  clearGuestCart,\n  deleteGuestItem,\n  clearUserCart\n} from \"../actions/itemActions\";\nimport { Modal, Button } from \"bootstrap-4-react\";\nimport { withRouter } from \"react-router-dom\";\nclass CartModal extends Component {\n  state = {\n    itemsCleared: false\n  };\n\n  onClearItemsButton() {\n    clearInterval(this.state.itemsCleared);\n    this.setState(\n      {\n        itemsCleared: true\n      },\n      () => {\n        setInterval(() => {\n          this.setState({\n            itemsCleared: false\n          });\n        }, 5000);\n      }\n    );\n  }\n  componentDidMount = () => {\n    this.addGuestCartToUser();\n  };\n\n  onClearUserCart = (user, items) => {\n    this.props.clearUserCart(user, items);\n  };\n\n  onClearGuestCart = () => {\n    this.props.clearGuestCart();\n  };\n  deleteGuestCartItem = item => {\n    this.props.deleteGuestItem(item);\n    this.props.getGuestCartItems();\n  };\n\n  render() {\n    const { items } = this.props.item;\n    const { user } = this.props.auth;\n    const { isAuthenticated } = this.props.auth;\n    const { guestCart } = this.props.item;\n\n    const deleteCartItem = item => {\n      this.props.getItems();\n      this.props.deleteItem(item._id);\n    };\n\n    let cartFilteredItems = isAuthenticated\n      ? items.filter(\n          item => item.userRefID !== \"\" && item.userRefID === user._id\n        )\n      : guestCart;\n\n    let cartTotal =\n      cartFilteredItems &&\n      cartFilteredItems.reduce((prev, current) => prev + current.price, 0);\n    let shippingCost = cartTotal && cartTotal > 100 ? 0 : 7.99;\n    let cartTotalTax = cartTotal && cartTotal * 0.15;\n    let cartTotalWithTax = cartTotal && cartTotal + cartTotalTax + shippingCost;\n\n    const loggedCheckout = () => {\n      this.props.history.push({\n        pathname: \"/payment\",\n        state: cartTotalWithTax\n      });\n    };\n\n    const guestCheckout = () => {\n      this.props.history.push({\n        pathname: \"/payment\",\n        state: cartTotalWithTax\n      });\n    };\n    let unique = [\n      ...new Set(cartFilteredItems && cartFilteredItems.map(item => item.name))\n    ];\n    // const duplicateCart = unique.map(item => [\n    //   item,\n    //   unique.filter(str => str === item).length\n    // ]);\n    // console.log(unique);\n    // console.log(duplicateCart);\n\n    return (\n      <div>\n        <Modal id=\"exampleModal\" fade>\n          <Modal.Dialog centered className=\"m-auto\">\n            <Modal.Content>\n              <Modal.Header className=\"p-3 border-dark\">\n                <Modal.Title\n                  style={{ textTransform: \"capitalize\" }}\n                  className=\"float-left w-25 font-wieght-bolder\"\n                >\n                  {isAuthenticated ? `${user.name}'s Cart` : \"Guest Cart\"}\n                </Modal.Title>\n                <Modal.Close className=\"float-right modal-closing\">\n                  <span aria-hidden=\"true\" className=\"float-right mr-2\">\n                    &times;\n                  </span>\n                </Modal.Close>\n              </Modal.Header>\n\n              <div className=\"py-3 w-75 mx-auto\">\n                <h2>My Bag</h2>\n                <h5 className=\"m-3 mx-auto\">\n                  Qty in cart:{\" \"}\n                  {cartFilteredItems && cartFilteredItems.length === null\n                    ? 0\n                    : cartFilteredItems && cartFilteredItems.length}\n                </h5>\n\n                {cartFilteredItems &&\n                  cartFilteredItems.map((item, i) => (\n                    <div\n                      className=\"py-4 row border-top border-bottom border-secondary \"\n                      key={i}\n                    >\n                      <div className=\"col-6 image-container m-auto\">\n                        <img\n                          className=\"img-fluid center-block w-100 align-items-center\"\n                          src={item.productImage}\n                          alt=\"\"\n                        />\n                      </div>\n                      <div className=\"col-6 d-flex flex-column justify-content-between\">\n                        {/* <p>{i}</p> */}\n                        {/* <h5>GuestID: {item.guestItemID && item.guestItemID}</h5> */}\n                        <h4 className=\"pb-3\">{item.name}</h4>\n                        <p className=\"pb-3\">Description: {item.description}</p>\n\n                        {/* <p>Category: {item.category}</p> */}\n                        <p className=\"pb-3\">Price: ${item.price}</p>\n                        <div className=\"text-center\">\n                          <button\n                            className=\"btn btn-primary w-50 p-2\"\n                            onClick={\n                              isAuthenticated\n                                ? () => deleteCartItem(item)\n                                : () => this.deleteGuestCartItem(item)\n                            }\n                          >\n                            Remove\n                          </button>\n\n                          <div className=\"m-3\"></div>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n              </div>\n\n              <button\n                type=\"button\"\n                className={\n                  \"col-12 my-2 p-2 w-75 mx-auto mb-4 btn \" +\n                  (!this.state.itemsCleared ? \"btn-info\" : \"btn-success\")\n                }\n                onClick={\n                  isAuthenticated\n                    ? () => {\n                        this.onClearUserCart(user, items);\n                        this.onClearItemsButton();\n                      }\n                    : () => {\n                        this.onClearGuestCart();\n                        this.onClearItemsButton();\n                      }\n                }\n              >\n                {!this.state.itemsCleared ? \"Reset Cart\" : \"Cart Cleared!\"}\n              </button>\n\n              <Modal.Footer className=\"border-dark row px-5 py-3 \">\n                <div className=\"justify-content-center w-100\">\n                  <h5 className=\"pt-4 pb-2\">\n                    Cart Total: {cartTotal && cartTotal.toFixed(2)}\n                  </h5>\n                  <h5 className=\" pt-2 pb-2\">\n                    Shipping & Handling:{\" \"}\n                    {cartTotal > 100\n                      ? \"FREE\"\n                      : cartTotal === 0\n                      ? \"0\"\n                      : shippingCost}\n                  </h5>\n                  <h5 className=\"pt-2 pb-3\">\n                    Tax: {cartTotalTax && cartTotalTax.toFixed(2)}\n                  </h5>\n                </div>\n\n                <h3 className=\"font-weight-bolder border-top border-secondary py-4 w-100\">\n                  Order total ({cartFilteredItems && cartFilteredItems.length}{\" \"}\n                  item): ${cartTotalWithTax && cartTotalWithTax.toFixed(2)}\n                </h3>\n\n                <Button\n                  className=\"col-12 my-1 p-2 my-3\"\n                  secondary\n                  data-dismiss=\"modal\"\n                >\n                  Close cart\n                </Button>\n\n                <Button\n                  data-dismiss=\"modal\"\n                  className=\"btn btn-primary btn-danger col-12 mt-2 mb-4 w-25 p-2\"\n                  onClick={\n                    isAuthenticated\n                      ? () => loggedCheckout(cartTotalWithTax)\n                      : () => guestCheckout(cartTotalWithTax)\n                  }\n                >\n                  PROCEED TO CHECKOUT\n                </Button>\n              </Modal.Footer>\n            </Modal.Content>\n          </Modal.Dialog>\n        </Modal>\n      </div>\n    );\n  }\n}\nconst mapStateToProps = state => ({\n  item: state.item,\n  auth: state.auth\n});\nexport default connect(mapStateToProps, {\n  deleteItem,\n\n  addItem,\n  getItems,\n  getGuestCartItems,\n  clearGuestCart,\n  deleteGuestItem,\n  clearUserCart\n})(withRouter(CartModal));\n"]},"metadata":{},"sourceType":"module"}